<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Extracting_Unique_Elements_from_"> Extracting Unique Elements from a List </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You want to eliminate duplicate values from a list.
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
There are several possible solutions for this problem.  Here are some
of these:
<p />
<p />
<h4><a name="Using_SRFI_1"> </a> Using <a href="/Cookbook/SRFI">SRFI</a> 1 </h4>
<p />
<code>SRFI 1</code> includes a procedure <code>delete-duplicates</code>.
<p />
<h4>
  <a name="Using_a_hash_table"> Using a hash table </a>
</h4>
<p />
The usual <code>delete-duplicates</code>, such as the one shipped with <code>SRFI 1</code>,
are standard recursive procedures, that in the worst case have to go
twice over the whole list.  It is standard thus to use a hash table to
<em>recall</em> the values we have already seen, or the values we have
already added to the result, and in one single pass over the list
construct the result without duplicates.
<p />
<p />
This first attempt, has a <code>loop</code> procedure (see
<span style="background : #FFFFCE;">
  <font color="#0000FF">ProcedureRecipeRecursive</font>
</span><a href="/edit/Cookbook/ProcedureRecipeRecursive?topicparent=Cookbook.ListRecipeExtractingUniqueElements">?</a> to learn how to use <em>named</em> let) that
traverses the list, adding each unseen element to the hash, and it
also adds this new element to the result lists, <code>ans</code>.
<p />
<div class="scheme">
  <pre>(<span class="keyword">define</span> <span class="variable">remove-duplicates</span>
  (<span class="keyword">lambda</span> (<span class="variable">l</span>)
    (<span class="keyword">let</span> ((<span class="variable">h</span> (<span class="variable">make-hash-table</span> <span class="keyword">'</span><span class="variable">equal</span>)))
      (<span class="keyword">let</span> <span class="variable">loop</span> ((<span class="variable">l</span> <span class="variable">l</span>) (<span class="variable">ans</span> <span class="keyword">'</span>()))
        (<span class="keyword">cond</span> ((<span class="builtin">null?</span> <span class="variable">l</span>) <span class="variable">ans</span>)
              ((<span class="variable">hash-table-get</span> <span class="variable">h</span> (<span class="builtin">car</span> <span class="variable">l</span>) (<span class="keyword">lambda</span> () <span class="selfeval">#f</span>))
               (<span class="variable">loop</span> (<span class="builtin">cdr</span> <span class="variable">l</span>) <span class="variable">ans</span>))
              (<span class="keyword">else</span>
               (<span class="variable">hash-table-put!</span> <span class="variable">h</span> (<span class="builtin">car</span> <span class="variable">l</span>) <span class="selfeval">#t</span>)
               (<span class="variable">loop</span> (<span class="builtin">cdr</span> <span class="variable">l</span>) (<span class="builtin">append</span> <span class="variable">ans</span> (<span class="builtin">list</span> (<span class="builtin">car</span> <span class="variable">l</span>))))))))))
</pre>
</div>
<p />
We can do better than that by noticing two things:
<p />
<ul>
<li> Both libraries: <code>list.ss</code> from <code>Mzlib</code>, and <code>SRFI 1</code> provide a procedure named <code>filter</code>, similar to <code>map</code> except that it only collects the results that pass a given test.
</li>
<li> When a value is not found in a hash table, a failure thunk is executed, so we can customize this thunk to do what we want, as in:
</li>
</ul>
<p />
<div class="scheme">
  <pre>(<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"1.ss"</span> <span class="selfeval">"srfi"</span>)) <span class="comment">;; for filter
</span>
(<span class="keyword">define</span> <span class="variable">remove-duplicates</span>
  (<span class="keyword">lambda</span> (<span class="variable">l</span>)
    (<span class="keyword">let</span> ((<span class="variable">h</span> (<span class="variable">make-hash-table</span> <span class="keyword">'</span><span class="variable">equal</span>)))
      (<span class="variable">filter</span> (<span class="keyword">lambda</span> (<span class="variable">elem</span>)
                (<span class="variable">hash-table-get</span> <span class="variable">h</span>
                                <span class="variable">elem</span>
                                (<span class="keyword">lambda</span> ()
                                  (<span class="variable">hash-table-put!</span> <span class="variable">h</span> <span class="variable">elem</span> <span class="selfeval">#f</span>)
                                  <span class="selfeval">#t</span>)))
              <span class="variable">l</span>))))
</pre>
</div>
<p />
<p />
<p />
<p />
<hr>
<p />
<h3>
  <a name="Comments_about_this_recipe"> Comments about this recipe </a>
</h3>
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/FranciscoSolsona">FranciscoSolsona</a> - 19 May 2004
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/ListRecipes">ListRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> Next Topic:</th>
  <td align="left">  </td>
</tr>
</table>
<p />
 </div>
</div>
