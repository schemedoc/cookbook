<div id="contentbox">
 <div class="widget">
  <p />
<h2><a name="Upgrading_your_PLT_v208_code_to_"> </a> Upgrading your PLT v208 code to work with PLT v299 </h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
PLT v299 (soon to be PLT v300) is different from PLT v208 (its predecessor), and code that
works with v208 needs work in order to work with v299.  This 'recipe'
attempts to provide summaries and links regarding the changes -- An upgrade FAQ, if you will.
<p />
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
<ul>
<li> Matthew Flatt has written the authoritative guide to upgrading: <a href="http://pre.plt-scheme.org/plt/notes/mzscheme/MzScheme_300.txt" target="_top">mzscheme_300 notes</a>
</li>
</ul>
<p />
Additional information about changes in <a href="/Cookbook/MzScheme">MzScheme</a>, <a href="/Cookbook/MrEd">MrEd</a>, and <a href="/Cookbook/DrScheme">DrScheme</a> is available in their history files:
<ul>
<li> <a href="http://download.plt-scheme.org/scheme/plt/notes/mzscheme/HISTORY" target="_top">http://download.plt-scheme.org/scheme/plt/notes/mzscheme/HISTORY</a>
</li>
<li> <a href="http://download.plt-scheme.org/scheme/plt/notes/mred/HISTORY" target="_top">http://download.plt-scheme.org/scheme/plt/notes/mred/HISTORY</a>
</li>
<li> <a href="http://download.plt-scheme.org/scheme/plt/notes/drscheme/HISTORY" target="_top">http://download.plt-scheme.org/scheme/plt/notes/drscheme/HISTORY</a>
</li>
</ul>
<p />
You may also be interested in the <a href="http://download.plt-scheme.org/chronology/" target="_top">chronology page</a>, which includes announcements up through 299.12.
<p />
<h3>
  <a name="Notes_from_Doug_Orleans_"> Notes from Doug Orleans: </a>
</h3>
<p />
These are notes made by Doug Orleans after upgrading a substantial block of servlet
code to 299:
<p />
Now that I've finally gotten all my servlets to work with v299 again,
here's a list of the changes I ran into that seems to be
un(der)documented.  Hopefully this will make it easier for anyone else
who might be planning follow the same path.  I already posted about
some of these but I'm collecting them all here in one place for the record.
However, I'm leaving out a few bugs (which I've reported via help-desk),
on the assumption that they'll be fixed before v300 so you won't have
to think about a workaround.
<p />
<ul>
<li> `with-semaphore' in `(lib "thread.ss")' has been removed, but the
  new primitive `call-with-sempahore' seems to be the same thing.
  There is a note in HISTORY about useless procedures in "thread.ss"
  being removed, but it still took me a little while to figure out the
  replacement.
</li>
</ul>
<p />
<ul>
<li> `url-query' in `(lib "url.ss" "net")' returns a list of
  symbol/string pairs instead of a string or #f.  If the query part of
  the URI doesn't include an equals sign, the whole query becomes a
  symbol mapped to the empty string.  `alist-&gt;forml-urlencoded' will
  convert the alist back to a string, but appends an equals sign if
  there is none.
</li>
</ul>
<p />
<ul>
<li> `url-path' in `(lib "url.ss" "net")' returns a list of strings
  instead of string or #f.  This is alluded to in HISTORY due to the
  realization that rfc2396 allows params to be attached to each path
  segment of a URI.
</li>
</ul>
<p />
<ul>
<li> `(lib "servlet-helpers.ss" "web-server")' is no longer needed,
  because `(lib "servlet-sig.ss" "web-server")' provides all its
  symbols.  In fact, you can't require both or you'll get duplicate
  symbols.  This change was announced on this list but it's not in
  <a href="/Cookbook/MzScheme">MzScheme</a>_300.txt or HISTORY.
</li>
</ul>
<p />
<ul>
<li> `request-headers' in `(lib "servlet-sig.ss" "web-server")' is a
  list of symbol/bytes pairs instead of symbol/string pairs.
  `request-bindings' is still a list of symbol/string pairs.
</li>
</ul>
<p />
<ul>
<li> The `response/full' and `response/incremental' structs have been
  moved from `(lib "servlet-sig.ss" "web-server")' to
  `(lib "response.ss" "web-server")'.  The "mime" field is a bytes
  instead of a string.  The field accessors and mutators are no longer
  provided, i.e. the structs are opaque.
</li>
</ul>
<p />
<ul>
<li> Errors while handling web-server requests are now reported to
  stderr.  I think the errors are generally innocuous, for example:
</li>
</ul>
<p />
<ul>
<li>
<ul>
<li> tcp-read: error reading (Connection reset by peer; errno=104)
</li>
<li> tcp-write: error writing (Broken pipe; errno=32)
</li>
<li> tcp-write: error writing (Connection reset by peer; errno=104)
</li>
<li> read-request: http input closed abruptly
</li>
<li> tcp-addresses: could not get peer address (Transport endpoint is not connected; errno=107)
</li>
</ul>
</li>
</ul>
<p />
  Arguably some or all of these should just be handled silently.
<p />
<a href="mailto:--dougo@place-NOSPAM.org">--dougo@place-NOSPAM.org</a>
<p />
<p />
<p />
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<p />
<p />
<p />
<p />
<hr>
<p />
<h3>
  <a name="Comments_about_this_recipe"> Comments about this recipe </a>
</h3>
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/JohnClements">JohnClements</a> - 18 Oct 2004
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left">  </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 999 </td>
</tr>
</table>
<p />
 </div>
</div>
