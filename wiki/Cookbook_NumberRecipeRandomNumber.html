<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Generating_Random_Numbers"> Generating Random Numbers  </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You want a random number from a given range.  For example, you wish to randomly select one element from an array, simulate rolling a die in a game of chance, or generate a random password.
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
Use <code>(random-integer n)</code> function from <span style="background : #FFFFCE;">
  <font color="#0000FF">SRFI27</font>
</span><a href="/edit/Cookbook/SRFI27?topicparent=Cookbook.NumberRecipeRandomNumber">?</a>.  It returns a random <code>exact</code> integer
in the range of 0 to n-1.
<p />
<div class="scheme">
  <pre><span class="builtin">&gt;</span> (<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"27.ss"</span> <span class="selfeval">"srfi"</span>))
<span class="builtin">&gt;</span> (<span class="variable">random-integer</span> <span class="selfeval">172</span>)
<span class="selfeval">58</span>
</pre>
</div>
<p />
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<p />
This code generates and prints a random integer between 25 and 75, inclusive:
<p />
<div class="scheme">
  <pre><span class="builtin">&gt;</span> (<span class="keyword">let</span> ((<span class="variable">rand</span> (<span class="builtin">+</span> (<span class="variable">random-integer</span> <span class="selfeval">51</span>) <span class="selfeval">25</span>)))
    (<span class="builtin">for-each</span> <span class="builtin">display</span> (<span class="builtin">list</span> <span class="selfeval">"Random = "</span> <span class="variable">rand</span> <span class="selfeval">"\n"</span>)))
<span class="variable">Random</span> <span class="builtin">=</span> <span class="selfeval">40</span>
</pre>
</div>
<p />
In the example, we want to limit the range to 25 to 75, so we add 25 to the result of the <code>random</code> function.  This means we really want a random number between 0 and 50, so we give the <code>random</code> function the argument 51 (since the generated number is always from 0 to n-1).
<p />
The canonical application for this kind of number generation is the random selection of an element from a vector:
<p />
<div class="scheme">
  <pre><span class="builtin">&gt;</span> (<span class="keyword">define</span> <span class="variable">myvec</span> <span class="selfeval">#</span>(<span class="selfeval">#\A</span> <span class="selfeval">#\B</span> <span class="selfeval">#\C</span> <span class="selfeval">#\D</span> <span class="selfeval">#\1</span> <span class="selfeval">#\2</span> <span class="selfeval">#\3</span>))
<span class="builtin">&gt;</span> (<span class="keyword">define</span> <span class="variable">elt</span>
    (<span class="builtin">vector-ref</span> <span class="variable">myvec</span> (<span class="variable">random-integer</span> <span class="selfeval">7</span>))
<span class="builtin">&gt;</span> <span class="variable">elt</span>
<span class="selfeval">#\B</span>
</pre>
</div>
<p />
Another common example is generating a random password.  For this example, we will make use of <a href="/Cookbook/SRFI">SRFI</a> 14 (Character Set Library) and
<a href="/Cookbook/SRFI">SRFI</a> 42 (List Comprehensions):
<p />
<div class="scheme">
  <pre>(<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"14.ss"</span> <span class="selfeval">"srfi"</span>)
         (<span class="variable">lib</span> <span class="selfeval">"27.ss"</span> <span class="selfeval">"srfi"</span>)
         (<span class="variable">lib</span> <span class="selfeval">"42.ss"</span> <span class="selfeval">"srfi"</span>))
(<span class="keyword">define</span> (<span class="variable">generate-8-password</span>)
  (<span class="variable">string-append-ec</span> (<span class="selfeval">:range</span> <span class="variable">i</span> <span class="selfeval">0</span> <span class="selfeval">8</span>)
                    (<span class="keyword">let*</span> ((<span class="variable">bigcs</span> (<span class="builtin">substring</span> (<span class="variable">char-set-&gt;string</span> <span class="variable">char-set:ascii</span>) <span class="selfeval">6</span> <span class="selfeval">95</span>))
                           (<span class="variable">rand</span> (<span class="variable">random-integer</span> (<span class="builtin">string-length</span> <span class="variable">bigcs</span>))))
                      (<span class="builtin">substring</span> <span class="variable">bigcs</span> <span class="variable">rand</span> (<span class="builtin">+</span> <span class="variable">rand</span> <span class="selfeval">1</span>)))))
<span class="builtin">&gt;</span> (<span class="variable">generate-8-password</span>)
<span class="selfeval">"n9R*g(la"</span>
</pre>
</div>
<p />
<h3>
  <a name="See_Also"> See Also </a>
</h3>
<p />
<a href="/Cookbook/NumberRecipeBigRandomNumber">NumberRecipeBigRandomNumber</a>
<p />
<p />
<p />
<p />
<h3>
  <a name="Comments"> Comments </a>
</h3>
<p />
I would compute <code>bigcs</code> only once:
<p />
<div class="scheme">
  <pre>(<span class="keyword">define</span> <span class="variable">generate-8-password</span>
  (<span class="keyword">let*</span> ((<span class="variable">bigcs</span>        (<span class="builtin">substring</span> (<span class="variable">char-set-&gt;string</span> <span class="variable">char-set:ascii</span>) <span class="selfeval">6</span> <span class="selfeval">95</span>))
         (<span class="variable">bigcs-length</span> (<span class="builtin">string-length</span> <span class="variable">bigcs</span>)))
    (<span class="keyword">lambda</span> ()
      (<span class="variable">string-append-ec</span> (<span class="selfeval">:range</span> <span class="variable">i</span> <span class="selfeval">0</span> <span class="selfeval">8</span>)
                        (<span class="keyword">let</span> ((<span class="variable">rand</span> (<span class="variable">random-integer</span> <span class="variable">bigcs-length</span>)))
                          (<span class="builtin">substring</span> <span class="variable">bigcs</span> <span class="variable">rand</span> (<span class="builtin">+</span> <span class="variable">rand</span> <span class="selfeval">1</span>)))))))
</pre>
</div>
<p />
Two other implementations that don't rely on <a href="/Cookbook/SRFI">SRFI</a>s but are much more verbose (and assume <code>integer-&gt;char</code> is equivalent to <code>ascii-&gt;char</code>):
<p />
<div class="scheme">
  <pre>(<span class="keyword">define</span> <span class="variable">generate-8-password</span>
  (<span class="keyword">let*</span> ((<span class="variable">password-length</span> <span class="selfeval">8</span>)
         (<span class="variable">min-ascii</span>       <span class="selfeval">33</span>)
         (<span class="variable">max-ascii</span>       <span class="selfeval">95</span>)
         (<span class="variable">random-argument</span> (<span class="builtin">+</span> <span class="selfeval">1</span> (<span class="builtin">-</span> <span class="variable">max-ascii</span> <span class="variable">min-ascii</span>))))
    (<span class="keyword">lambda</span> ()
      (<span class="builtin">apply</span> <span class="builtin">string</span>
             (<span class="keyword">let</span> <span class="variable">loop</span> ((<span class="variable">i</span> <span class="variable">password-length</span>))
               (<span class="keyword">if</span> (<span class="builtin">zero?</span> <span class="variable">i</span>)
                   <span class="keyword">'</span>()
                   (<span class="builtin">cons</span> (<span class="builtin">integer-&gt;char</span> (<span class="builtin">+</span> (<span class="variable">random-integer</span> <span class="variable">random-argument</span>)
                                           <span class="variable">min-ascii</span>))
                         (<span class="variable">loop</span> (<span class="builtin">-</span> <span class="variable">i</span> <span class="selfeval">1</span>)))))))))
</pre>
</div>
<p />
The second is for implementations with fast <code>string-set!</code>.
<p />
<div class="scheme">
  <pre>(<span class="keyword">define</span> <span class="variable">generate-8-password</span>
  (<span class="keyword">let*</span> ((<span class="variable">password-length</span> <span class="selfeval">8</span>)            <span class="comment">; must be &gt;= 1
</span>         (<span class="variable">min-ascii</span>       <span class="selfeval">33</span>)
         (<span class="variable">max-ascii</span>       <span class="selfeval">95</span>)
         (<span class="variable">random-argument</span> (<span class="builtin">+</span> <span class="selfeval">1</span> (<span class="builtin">-</span> <span class="variable">max-ascii</span> <span class="variable">min-ascii</span>))))
    (<span class="keyword">lambda</span> ()
      (<span class="keyword">let</span> ((<span class="variable">password</span> (<span class="builtin">make-string</span> <span class="variable">password-length</span>)))
        (<span class="keyword">let</span> <span class="variable">loop</span> ((<span class="variable">i</span> (<span class="builtin">-</span> <span class="variable">password-length</span> <span class="selfeval">1</span>)))
          (<span class="builtin">string-set!</span> <span class="variable">password</span>
                       <span class="variable">i</span>
                       (<span class="builtin">integer-&gt;char</span> (<span class="builtin">+</span> (<span class="variable">random-integer</span> <span class="variable">random-argument</span>)
                                         <span class="variable">min-ascii</span>)))
          (<span class="keyword">if</span> (<span class="builtin">zero?</span> <span class="variable">i</span>)
              <span class="variable">password</span>
              (<span class="variable">loop</span> (<span class="builtin">-</span> <span class="variable">i</span> <span class="selfeval">1</span>))))))))
</pre>
</div>
<p />
If I had first-year CS students, I would make them do it the verbose way.  Although list comprehensions are probably more appealing to most Cookbook users, and perhaps are easier for the compiler to optimize in some cases.
<p />
-- <a href="/Main/NeilVanDyke">NeilVanDyke</a> - 11 Jun 2004
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/NumberRecipes">NumberRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 070 </td>
</tr>
</table>
<p />
 </div>
</div>
