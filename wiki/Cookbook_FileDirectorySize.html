<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Computing_the_Size_of_a_Director"> Computing the Size of a Directory </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You want to compute the total size of a directory tree (i.e. the sum of the file sizes in a directory tree).
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
<div class="scheme">
  <pre>(<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"file.ss"</span>))
(<span class="variable">fold-files</span> (<span class="keyword">lambda</span> (<span class="variable">f</span> <span class="variable">type</span> <span class="variable">a</span>)
              (<span class="keyword">if</span> (<span class="builtin">eq?</span> <span class="variable">type</span> <span class="keyword">'</span><span class="variable">file</span>)
                  (<span class="builtin">+</span> <span class="variable">a</span> (<span class="variable">file-size</span> <span class="variable">f</span>))
                  <span class="variable">a</span>))
            <span class="selfeval">0</span>
            <span class="variable">path</span>)
</pre>
</div>
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<p />
<code>fold-files</code> in PLT's <code>file.ss</code> pretty much has this built in.  All you need to add is a procedure to accumulate the size of the files.
<p />
For a little twist, here's a version that collects the total file size in the <code>car</code> of a pair and the number of files in the <code>cdr</code>:
<p />
<div class="scheme">
  <pre>(<span class="variable">fold-files</span> (<span class="keyword">lambda</span> (<span class="variable">f</span> <span class="variable">type</span> <span class="variable">a</span>)
              (<span class="keyword">let</span> ((<span class="variable">size</span> (<span class="builtin">car</span> <span class="variable">a</span>))
                    (<span class="variable">cnt</span> (<span class="builtin">cdr</span> <span class="variable">a</span>)))
                (<span class="keyword">if</span> (<span class="builtin">eq?</span> <span class="variable">type</span> <span class="keyword">'</span><span class="variable">file</span>)
                    (<span class="keyword">begin</span>
                      (<span class="builtin">set-car!</span> <span class="variable">a</span> (<span class="builtin">+</span> <span class="variable">size</span> (<span class="variable">file-size</span> <span class="variable">f</span>)))
                      (<span class="builtin">set-cdr!</span> <span class="variable">a</span> (<span class="builtin">+</span> <span class="variable">cnt</span> <span class="selfeval">1</span>))
                      <span class="variable">a</span>)
                    <span class="variable">a</span>)))
            (<span class="builtin">cons</span> <span class="selfeval">0</span> <span class="selfeval">0</span>)
            <span class="variable">path</span>)
</pre>
</div>
<p />
<p />
<hr>
<p />
<h3>
  <a name="Comments_about_this_recipe"> Comments about this recipe </a>
</h3>
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/GordonWeakliem">GordonWeakliem</a> - 13 Aug 2004
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/FileRecipes">FileRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 999 </td>
</tr>
</table>
<p />
 </div>
</div>
