<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Getting_Started_With_Web_Develop"> Getting Started With Web Development and Instaweb </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You don't know how to get started with web development using the PLT Web server.
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
The <code>Instaservlet</code> program takes care of configuring the Web server and your servlet for most common configurations.  The other <code>WebRecipes</code> and <a href="http://docs.plt-scheme.org/web-server/" target="_top">the Web server documentation</a> should help answer any questions with the actual programming of servlets.
<p />
To create a servlet with <code>Instaservlet</code>, you need only write a function from a request to a response.  You don't have to write any configuration code.  So, for example, here is a simple servlet that displays a demonstration page:
<p />
<div class="scheme">
  <pre><span class="selfeval">#lang</span> <span class="variable">scheme/base</span>
<span class="comment">;; Require Instaservlet
</span>(<span class="keyword">require</span> (<span class="variable">planet</span> <span class="selfeval">"instaservlet.ss"</span> (<span class="selfeval">"untyped"</span> <span class="selfeval">"instaservlet.plt"</span> <span class="selfeval">1</span>)))
<span class="comment">;; A very simple servlet
</span>(<span class="keyword">define</span> (<span class="variable">start</span> <span class="variable">initial-request</span>)
  <span class="keyword">'</span>(<span class="variable">html</span>
      (<span class="variable">head</span>
       (<span class="variable">title</span> <span class="selfeval">"Demonstration Page"</span>))
      (<span class="variable">body</span>
       (<span class="variable">h1</span> <span class="selfeval">"Demonstration Page"</span>)
       (<span class="variable">p</span> <span class="selfeval">"This is a simple servlet demonstration page"</span>))))
<span class="comment">;; Run the servlet
</span>(<span class="variable">go!</span> <span class="variable">start</span>)
</pre>
</div>
<p />
Run this code and you can view the resulting webpage at <a href="http://localhost:8765/" target="_top">http://localhost:8765/</a>
<p />
By default <code>Instaservlet</code> runs the web server on port 8765, but this, and many other configuration options, can be changed by passing keyword arguments to <code>go!</code>.  For example, to run on port 1234:
<p />
<div class="scheme">
  <pre>(<span class="variable">go!</span> <span class="variable">start</span> <span class="variable">#:port</span> <span class="selfeval">1234</span>)
</pre>
</div>
<p />
Here's a slightly more involved example of a servlet that gets arguments sent to the servlet, along with some embedded javascript (intended to be bookmarked) that allows you to extract select text and metadata (url and title) from an arbitrary page and send it to the servlet:
<p />
<div class="scheme">
  <pre><span class="selfeval">#lang</span> <span class="variable">scheme/base</span>
(<span class="keyword">require</span>
   <span class="variable">web-server/servlet</span>
   (<span class="variable">planet</span> <span class="selfeval">"instaservlet.ss"</span> (<span class="selfeval">"untyped"</span> <span class="selfeval">"instaservlet.plt"</span> <span class="selfeval">1</span>)))
<span class="comment">;; start : request -&gt; response
</span>(<span class="keyword">define</span> (<span class="variable">start</span> <span class="variable">initial-request</span>)
  (<span class="keyword">define</span> <span class="variable">binding-list</span> (<span class="variable">format</span> <span class="selfeval">"~s"</span>(<span class="variable">request-bindings</span> <span class="variable">initial-request</span>)))
  <span class="keyword">`</span>(<span class="variable">html</span> (<span class="variable">head</span> (<span class="variable">title</span> <span class="selfeval">"A Test Page"</span>))
         (<span class="variable">body</span> ([<span class="variable">bgcolor</span> <span class="selfeval">"white"</span>])
               (<span class="variable">p</span> <span class="selfeval">"Query;"</span>
                  (<span class="variable">div</span> ((<span class="variable">class=</span><span class="selfeval">"aboutsmall"</span>))
                       (<span class="variable">p</span> <span class="selfeval">"Drag this link: "</span> (<span class="variable">a</span> ((<span class="variable">href</span> <span class="selfeval">"javascript:location.href='http://127.0.0.1:5678/?v=1;url='+encodeURIComponent(location.href)+';title='+encodeURIComponent(document.title)+';text=\\r'+escape(document.getSelection().replace(/\\s/g,' ').replace(/ {2,}/g,' '))"</span>) (<span class="variable">title</span> <span class="selfeval">"post to snatcher"</span>) (<span class="variable">onclick</span> <span class="selfeval">"window.alert('Drag this link to your bookmarks toolbar, or right-click it and choose Bookmark This Link...');return false;"</span>) ( <span class="variable">class</span> <span class="selfeval">"bookmarklet2"</span>)) <span class="selfeval">"post to snatcher"</span>) <span class="selfeval">" up to your Bookmarks Toolbar."</span>)
                       (<span class="variable">p</span> <span class="keyword">,</span>(<span class="builtin">string-append</span> <span class="selfeval">"text:"</span>  <span class="variable">binding-list</span>))
                       )))))
(<span class="variable">go!</span> <span class="variable">start</span> <span class="variable">#:port</span> <span class="selfeval">5678</span>)
</pre>
</div>
<p />
You can then launch a browser to visit this servlet, using:
<p />
<div class="scheme">
  <pre>(<span class="keyword">require</span>
 (<span class="variable">lib</span> <span class="selfeval">"url.ss"</span> <span class="selfeval">"net"</span>)
 <span class="comment">;; required to launch the browser with
</span> (<span class="variable">lib</span> <span class="selfeval">"external.ss"</span> <span class="selfeval">"browser"</span>))
(<span class="variable">send-url</span> <span class="selfeval">"http://127.0.0.1:5678/?v=1;url=2;title=aaa"</span>) <span class="comment">;; launch browser
</span></pre>
</div>
<p />
<p />
<code>Instaservlet</code> currently works only under PLT Scheme 4.  It you use 372 or an older version, you can still use <code>Instaweb</code>, which provides a front end to setup the Web server to run a single servlet, but does not provide a default servlet configuration.  Here's the first example using <code>Instaweb</code>.  First write a servlet in a file <code>demo.ss</code>:
<p />
<div class="scheme">
  <pre>(<span class="keyword">module</span> <span class="variable">demo</span> <span class="variable">mzscheme</span>
  (<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"servlet.ss"</span> <span class="selfeval">"web-server"</span>))
  (<span class="keyword">provide</span> <span class="variable">interface-version</span>
           <span class="variable">timeout</span>
           <span class="variable">start</span>)
  (<span class="keyword">define</span> <span class="variable">interface-version</span> <span class="keyword">'</span><span class="variable">v1</span>)
  (<span class="keyword">define</span> <span class="variable">timeout</span> <span class="variable">+inf.0</span>)
  (<span class="keyword">define</span> (<span class="variable">start</span> <span class="variable">initial-request</span>)
    <span class="keyword">'</span>(<span class="variable">html</span>
      (<span class="variable">head</span>
       (<span class="variable">title</span> <span class="selfeval">"Demonstration Page"</span>))
      (<span class="variable">body</span>
       (<span class="variable">h1</span> <span class="selfeval">"Demonstration Page"</span>)
       (<span class="variable">p</span> <span class="selfeval">"This is a simple servlet demonstration page"</span>))))
  )
</pre>
</div>
<p />
To setup the Web server to use this servlet, create another file called, say <code>run-demo.ss</code> which contains:
<p />
<div class="scheme">
  <pre>(<span class="keyword">require</span> (<span class="variable">planet</span> <span class="selfeval">"instaweb.ss"</span> (<span class="selfeval">"schematics"</span> <span class="selfeval">"instaweb.plt"</span> <span class="selfeval">1</span>)))
(<span class="variable">instaweb</span> <span class="selfeval">"demo.ss"</span> <span class="selfeval">8765</span>)
</pre>
</div>
<p />
Now load <code>run-demo.ss</code> into <a href="/Cookbook/DrScheme">DrScheme</a> (or <a href="/Cookbook/MzScheme">MzScheme</a>) and Execute it.  You should see output like:
<p />
<pre>
Web server started on port 8765
Visit URL http://localhost:8765/servlets/demo.ss
Type stop to stop the server and exit
Type restart to restart the server
</pre>
<p />
Now visit the URL and check that the servlet is working.  That's all!
<p />
<p />
<p />
<p />
<p />
<hr>
<p />
<h3>
  <a name="Comments_about_this_recipe"> Comments about this recipe </a>
</h3>
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/NoelWelsh">NoelWelsh</a> - 27 Nov 2006
-- <a href="/Main/StephenDeGabrielle">StephenDeGabrielle</a> - 15 Jan 2008
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/WebRecipes">WebRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 999 </td>
</tr>
</table>
<p />
 </div>
</div>
