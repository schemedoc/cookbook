<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="How_to_make_a_snip"> How to make a snip </a>
</h2>
<p />
see <a href="http://docs.plt-scheme.org/gui/snip_.html" target="_top">http://docs.plt-scheme.org/gui/snip_.html</a>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
You want to make a new type of snip for use on an editor-canvas
(PLT Scheme specific)
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
Here is a simple example of an implementation of string-snip%
<p />
I put it here because, while there are good examples in the <a href="/Cookbook/MrEd">MrEd</a> (gui) manual, this is one that isn't covered.
<p />
Use <a href="/Cookbook/DrScheme">DrScheme</a> language <a href="/Cookbook/MrEd">MrEd</a>
<p />
Basic procedure;
<ol>
<li> define a new subclass of snip
</li>
<li> override get-extent
</li>
<li> override draw
</li>
</ol>
<p />
Note
<ul>
<li> Didn't implement snipclass - though this would be necessary for copy-paste operations - as well as saving the editor using the snip. But this name nor be necessary.
</li>
</ul>
<p />
<div class="scheme">
  <pre>
<span class="selfeval">#lang</span> <span class="variable">scheme/gui</span>
(<span class="keyword">define</span> <span class="variable">my-string-snip%</span>
  (<span class="variable">class</span> <span class="variable">snip%</span>
    (<span class="variable">inherit</span> <span class="variable">set-snipclass</span> <span class="variable">get-style</span> <span class="variable">get-admin</span>)
    (<span class="variable">init-field</span>
     (<span class="variable">my-string</span> <span class="selfeval">"aaa  aaa"</span>))
    (<span class="variable">define/override</span> <span class="variable">get-extent</span>
      (<span class="keyword">lambda</span> (<span class="variable">dc</span> <span class="variable">x</span> <span class="variable">y</span> <span class="variable">w</span> <span class="variable">h</span> <span class="variable">descent</span> <span class="variable">space</span> <span class="variable">lspace</span> <span class="variable">rspace</span>)
        <span class="comment">;(for-each (lambda (b) (when (box? b) (set-box! b 0)))
</span>        <span class="comment">;           (list descent space lspace rspace))
</span>
        (<span class="keyword">let-values</span> (((<span class="variable">width</span> <span class="variable">height</span> <span class="variable">b</span> <span class="variable">s</span>) (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">get-text-extent</span> (<span class="variable">format</span> <span class="selfeval">"~A"</span> <span class="variable">my-string</span>) (<span class="variable">send</span> (<span class="variable">get-style</span>) <span class="variable">get-font</span>))))
          (<span class="keyword">when</span> (<span class="variable">box?</span> <span class="variable">w</span>) (<span class="variable">set-box!</span> <span class="variable">w</span> <span class="variable">width</span>))
          (<span class="keyword">when</span> (<span class="variable">box?</span> <span class="variable">h</span>) (<span class="variable">set-box!</span> <span class="variable">h</span> <span class="variable">height</span>)))))
    (<span class="variable">define/override</span> (<span class="variable">draw</span> <span class="variable">dc</span> <span class="variable">x</span> <span class="variable">y</span> <span class="variable">left</span> <span class="variable">top</span> <span class="variable">right</span> <span class="variable">bottom</span> <span class="variable">dx</span> <span class="variable">dy</span> <span class="variable">draw-caret?</span>)
      (<span class="keyword">let</span> ([<span class="variable">orig-pen</span> (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">get-pen</span>)]
            [<span class="variable">orig-brush</span> (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">get-brush</span>)]
            [<span class="variable">snip-w</span> (<span class="builtin">-</span> <span class="variable">right</span> <span class="variable">left</span>)]
            [<span class="variable">snip-h</span> (<span class="builtin">-</span> <span class="variable">bottom</span> <span class="variable">top</span>)])
        (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">set-pen</span> <span class="variable">body-pen</span>)
        (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">set-brush</span> <span class="variable">body-brush</span>)
        (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">draw-text</span> (<span class="variable">format</span> <span class="selfeval">"~A"</span> <span class="variable">my-string</span>) <span class="variable">x</span> <span class="variable">y</span>)
        (<span class="keyword">let-values</span> (((<span class="variable">width</span> <span class="variable">height</span> <span class="variable">b</span> <span class="variable">s</span>) (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">get-text-extent</span> (<span class="variable">format</span> <span class="selfeval">"~A"</span> <span class="variable">my-string</span>))))
          (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">draw-line</span> <span class="variable">x</span> <span class="variable">y</span> (<span class="builtin">+</span> <span class="variable">x</span> <span class="variable">width</span>) <span class="variable">y</span>))
        (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">set-pen</span> <span class="variable">orig-pen</span>)
        (<span class="variable">send</span> <span class="variable">dc</span> <span class="variable">set-brush</span> <span class="variable">orig-brush</span>))
      )
    (<span class="variable">super-instantiate</span> ())
    (<span class="variable">set-snipclass</span> <span class="variable">my-string-snipclass%</span>)
    ))
(<span class="keyword">define</span> <span class="variable">my-string-snipclass%</span>
  (<span class="variable">make-object</span>
      (<span class="variable">class</span> <span class="variable">snip-class%</span>
        (<span class="variable">define/override</span> (<span class="builtin">read</span> <span class="variable">s</span>)
          (<span class="variable">make-object</span> <span class="variable">my-string-snip%</span>))
        (<span class="variable">super-instantiate</span> ())
        )))
<span class="comment">;;;;;;;;;;;;;;;;
</span>
(<span class="keyword">define</span> <span class="variable">body-pen</span> (<span class="variable">send</span> <span class="variable">the-pen-list</span> <span class="variable">find-or-create-pen</span> <span class="selfeval">"blue"</span> <span class="selfeval">0</span> <span class="keyword">'</span><span class="variable">solid</span>))
(<span class="keyword">define</span> <span class="variable">body-brush</span> (<span class="variable">send</span> <span class="variable">the-brush-list</span> <span class="variable">find-or-create-brush</span> <span class="selfeval">"WHITE"</span> <span class="keyword">'</span><span class="variable">solid</span>))
(<span class="keyword">define</span> <span class="variable">f</span> (<span class="variable">instantiate</span> <span class="variable">frame%</span> (<span class="selfeval">"example"</span> <span class="selfeval">#f</span> <span class="selfeval">500</span> <span class="selfeval">300</span>) ))
(<span class="keyword">define</span> <span class="variable">c</span> (<span class="variable">new</span> <span class="variable">editor-canvas%</span> [<span class="variable">parent</span> <span class="variable">f</span>]))
(<span class="keyword">define</span> <span class="variable">p</span> (<span class="variable">new</span> <span class="variable">pasteboard%</span>))
(<span class="variable">send</span> <span class="variable">c</span> <span class="variable">set-editor</span> <span class="variable">p</span>)
(<span class="variable">send</span> <span class="variable">f</span> <span class="variable">show</span> <span class="selfeval">#t</span>)
<span class="comment">;(sleep 5)
</span>
(<span class="variable">send</span> <span class="variable">p</span> <span class="variable">insert</span> (<span class="variable">new</span> <span class="variable">my-string-snip%</span> (<span class="variable">my-string</span> <span class="selfeval">"ca"</span>)) <span class="selfeval">10</span> <span class="selfeval">80</span>)
(<span class="variable">send</span> <span class="variable">p</span> <span class="variable">insert</span> (<span class="variable">new</span> <span class="variable">my-string-snip%</span> (<span class="variable">my-string</span> <span class="selfeval">"c   a"</span>)) <span class="selfeval">10</span> <span class="selfeval">100</span>)
(<span class="variable">send</span> <span class="variable">p</span> <span class="variable">insert</span> (<span class="variable">new</span> <span class="variable">my-string-snip%</span> (<span class="variable">my-string</span> <span class="selfeval">"c      a"</span>)) <span class="selfeval">10</span> <span class="selfeval">120</span>)
(<span class="variable">send</span> <span class="variable">p</span> <span class="variable">insert</span> (<span class="variable">new</span> <span class="variable">my-string-snip%</span> (<span class="variable">my-string</span> <span class="selfeval">"c         a"</span>)) <span class="selfeval">10</span> <span class="selfeval">140</span>)
(<span class="variable">send</span> <span class="variable">p</span> <span class="variable">insert</span> (<span class="variable">new</span> <span class="variable">my-string-snip%</span> (<span class="variable">my-string</span> <span class="selfeval">"c            a"</span>)) <span class="selfeval">10</span> <span class="selfeval">160</span>)
</pre>
</div>
<p />
<p />
-- <a href="/Main/StephenDeGabrielle">StephenDeGabrielle</a> - 04 Aug 2008
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> GUIRecipes </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 676 </td>
</tr>
</table>
<p />
 </div>
</div>
