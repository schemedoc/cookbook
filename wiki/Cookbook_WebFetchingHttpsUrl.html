<div id="contentbox">
 <div class="widget">
  <p />
<h2><a name="Fetching_an_HTTPS_URL"> </a> Fetching an HTTPS URL </h2>
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
PLT Scheme's url.ss library in the net collection does not directly support retrieval of URLs via HTTPS, i.e. using SSL.
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
PLT's unit system can be used to create a version of the url module which does support HTTPS URLs.  Place the following code in a file called e.g. <code>ssl-url.scm</code>:
<p />
500 Can't connect to 127.0.0.1:8778 (connect: Connection refused)
<p />
<p />
You can then require this module using <code>(require "ssl-url.scm")</code>, and use the standard url API described in <a href="/Cookbook/WebFetchingURL">WebFetchingURL</a> to retrieve HTTPS URLs.
<p />
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<p />
This works by essentially creating a clone of PLT's <code>url.ss</code> module, and linking it with <code>ssl-tcp-unit.ss</code> instead of <code>tcp-unit.ss</code>.  The above code is simply a copy of <code>url.ss</code> with the relevant details changed.
<p />
Note that a module which uses the above module can only fetch SSL URLs.  Regular HTTP URLs can be fetched by requiring the original <code>url.ss</code>.  A module which needs to fetch both types of URL can do so by applying a prefix to the names of one of the modules, for example:
<p />
500 Can't connect to 127.0.0.1:8778 (connect: Connection refused)
<p />
<p />
...and then use procedure names like <code>ssl:get-pure-port</code> to retrieve SSL URLs.
<p />
Also note that this still supports <code>http://</code> URLs only.  You will need
to translate <code>https://foo.com/...</code> to <code>http://foo.com:443/...</code> (in
case it doesn't have a port).
<p />
<p />
<p />
<h3>
  <a name="Comments"> Comments </a>
</h3>
<p />
This code was based on an <a href="http://list.cs.brown.edu/pipermail/plt-scheme/2004-October/006813.html">example provided by Noel Welsh</a>.
<p />
-- <a href="/Main/AntonVanStraaten">AntonVanStraaten</a> - 29 Nov 2005
<p />
Ergo, Anton is a hero.
<p />
-- <a href="/Main/NoelWelsh">NoelWelsh</a> - 01 Dec 2005
<p />
Updated for PLT v370.
<p />
-- <a href="/Main/DaveGurnell">DaveGurnell</a> - 31 May 2007
<p />
I needed to change "unitsig.ss" to "unit.ss" to work in v371. I'd change the code but how to do that is not clear. :-P
<p />
-- <a href="/Main/PeteHopkins">PeteHopkins</a> - 04 Sep 2007
<p />
I've edited the code.  Some source is stored separately in the <a href="/Scm/WebHome">Scm</a> web with the intent of being able to easily produce a collection of source from the Cookbook.  Not that producing such a collection has actually been done, but it could be.  Easily. :)
<p />
-- <a href="/Main/AntonVanStraaten">AntonVanStraaten</a> - 05 Sep 2007
<p />
Here's an example of its use:
<pre>
#lang scheme
(require "ssl-url.ss")
(ssl:call/input-url
 (string-&gt;url "https://www.amazon.com/")
 ssl:get-impure-port
 (lambda (ip)
   (fprintf (current-error-port) "Look out, nellie!!~%")
   (copy-port ip (current-output-port))))
</pre>
<p />
-- <a href="/Main/EricHanchrow">EricHanchrow</a> - 17 Dec 2008
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/WebRecipes">WebRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 012 </td>
</tr>
</table>
<p />
 </div>
</div>
