<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Formatting_Scheme_Code"> Formatting Scheme Code </a>
</h2>
<h3>
  <a name="Problem"> Problem </a>
</h3>
You have some Scheme code (or any S-Expression) that you want to format readably
<h3>
  <a name="Solution"> Solution </a>
</h3>
<code>pretty-print</code> in mzlib is an easy way to do this.  Here's what it does with a function definition that has no newlines or indentation:
<div class="scheme">
  <pre><span class="builtin">&gt;</span> (<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"pretty.ss"</span>))
<span class="builtin">&gt;</span> (<span class="variable">pretty-print</span> <span class="keyword">'</span>(<span class="keyword">define</span> <span class="variable">string-pad-center</span> (<span class="variable">opt-lambda</span> (<span class="variable">a-string</span> <span class="variable">width</span> (<span class="variable">pad-char</span> <span class="selfeval">#\space</span>)) (<span class="keyword">let*</span> ((<span class="variable">field-width</span> (<span class="builtin">min</span> <span class="variable">width</span> (<span class="builtin">string-length</span> <span class="variable">a-string</span>))) (<span class="variable">rmargin</span> (<span class="builtin">floor</span> (<span class="builtin">/</span> (<span class="builtin">-</span> <span class="variable">width</span> <span class="variable">field-width</span>) <span class="selfeval">2</span>)))) (<span class="variable">string-pad</span> (<span class="variable">string-pad-right</span> <span class="variable">a-string</span> (<span class="builtin">-</span> <span class="variable">width</span> <span class="variable">rmargin</span>) <span class="variable">pad-char</span>) <span class="variable">width</span> <span class="variable">pad-char</span>)))))
(<span class="keyword">define</span> <span class="variable">string-pad-center</span>
  (<span class="variable">opt-lambda</span>
    (<span class="variable">a-string</span> <span class="variable">width</span> (<span class="variable">pad-char</span> <span class="selfeval">#\space</span>))
    (<span class="keyword">let*</span> ((<span class="variable">field-width</span> (<span class="builtin">min</span> <span class="variable">width</span> (<span class="builtin">string-length</span> <span class="variable">a-string</span>)))
           (<span class="variable">rmargin</span> (<span class="builtin">floor</span> (<span class="builtin">/</span> (<span class="builtin">-</span> <span class="variable">width</span> <span class="variable">field-width</span>) <span class="selfeval">2</span>))))
      (<span class="variable">string-pad</span>
        (<span class="variable">string-pad-right</span> <span class="variable">a-string</span> (<span class="builtin">-</span> <span class="variable">width</span> <span class="variable">rmargin</span>) <span class="variable">pad-char</span>)
        <span class="variable">width</span>
        <span class="variable">pad-char</span>))))
</pre>
</div>
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<code>pretty-print</code> takes an optional second argument which is a port that the output should be printed to.  <code>pretty-print</code> also has a number of options to control formatting.  <code>pretty-print-columns</code> is used to set the column width for formatting, when called without arguments, it returns the current setting.  <code>pretty-print-depth</code> is used to control how deeply the printer will inspect the structure.  Using the same example as above,
<div class="scheme">
  <pre><span class="builtin">&gt;</span> (<span class="keyword">define</span> <span class="variable">ugly-def</span> <span class="keyword">'</span>(<span class="keyword">define</span> <span class="variable">string-pad-center</span> (<span class="variable">opt-lambda</span> (<span class="variable">a-string</span> <span class="variable">width</span> (<span class="variable">pad-char</span> <span class="selfeval">#\space</span>)) (<span class="keyword">let*</span> ((<span class="variable">field-width</span> (<span class="builtin">min</span> <span class="variable">width</span> (<span class="builtin">string-length</span> <span class="variable">a-string</span>))) (<span class="variable">rmargin</span> (<span class="builtin">floor</span> (<span class="builtin">/</span> (<span class="builtin">-</span> <span class="variable">width</span> <span class="variable">field-width</span>) <span class="selfeval">2</span>)))) (<span class="variable">string-pad</span> (<span class="variable">string-pad-right</span> <span class="variable">a-string</span> (<span class="builtin">-</span> <span class="variable">width</span> <span class="variable">rmargin</span>) <span class="variable">pad-char</span>) <span class="variable">width</span> <span class="variable">pad-char</span>)))))
<span class="builtin">&gt;</span> (<span class="variable">pretty-print-depth</span> <span class="selfeval">0</span>)
<span class="builtin">&gt;</span> (<span class="variable">pretty-print</span> <span class="variable">ugly-def</span>)
(...)
<span class="builtin">&gt;</span> (<span class="variable">pretty-print-depth</span> <span class="selfeval">1</span>)
<span class="builtin">&gt;</span> (<span class="variable">pretty-print</span> <span class="variable">ugly-def</span>)
(<span class="keyword">define</span> <span class="variable">string-pad-center</span> (...))
<span class="builtin">&gt;</span> (<span class="variable">pretty-print-depth</span> <span class="selfeval">2</span>)
<span class="builtin">&gt;</span> (<span class="variable">pretty-print</span> <span class="variable">ugly-def</span>)
(<span class="keyword">define</span> <span class="variable">string-pad-center</span> (<span class="variable">opt-lambda</span> (...) (...)))
</pre>
</div>
<p />
<p />
-- <a href="/Main/GordonWeakliem">GordonWeakliem</a> - 26 Apr 2004
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/StringRecipes">StringRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 190 </td>
</tr>
</table>
<p />
 </div>
</div>
