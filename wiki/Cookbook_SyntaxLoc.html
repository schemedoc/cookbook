<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Using_syntax_loc_instead_of_synt"> Using <code>syntax/loc</code> instead of <code>syntax</code> </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You're tired of bad error messages and location information from your macros.
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
Use <code>syntax/loc</code> instead of <code>syntax</code> to produce your macro output from <code>syntax-case</code>.  For example (straight from the PLT manual), an <code>if-it</code> macro, which binds <code>it</code> to the result of the if predicate, would be written
<p />
<div class="scheme">
  <pre>(<span class="keyword">define-syntax</span> (<span class="variable">if-it</span> <span class="variable">stx</span>)
  (<span class="keyword">syntax-case</span> <span class="variable">stx</span> ()
    [(<span class="variable">src-if-it</span> <span class="variable">test</span> <span class="variable">then</span> <span class="keyword">else</span>)
     (<span class="keyword">with-syntax</span> ([<span class="variable">it</span> (<span class="variable">datum-&gt;syntax-object</span> (<span class="keyword">syntax</span> <span class="variable">src-if-it</span>) <span class="keyword">'</span><span class="variable">it</span>)])
       (<span class="variable">syntax/loc</span> <span class="variable">stx</span> (<span class="keyword">let</span> ([<span class="variable">it</span> <span class="variable">test</span>]) (<span class="keyword">if</span> <span class="variable">it</span> <span class="variable">then</span> <span class="keyword">else</span>))))]))
</pre>
</div>
<p />
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<p />
If you want a more extensive example of this, <a href="/Main/JensAxelSoegaard">JensAxelSoegaard</a> has re-written <a href="http://srfi.schemers.org/srfi-42" target="_top">SRFI-42</a> to use <code>syntax/loc</code>.  You can obtain the <a href="http://planet.plt-scheme.org/display.ss?package=srfi.plt&amp;amp;owner=soegaard" target="_top">package</a> from the <a href="/Cookbook/PLaneT">PLaneT</a> repository using <code>(require (planet "42.ss" ("soegaard" "srfi.plt" 2))</code>.
<p />
Using <code>syntax/loc</code> helps the PLT error reporting tools be much more specific about the location of errors in your code.
<p />
<p />
<hr>
<p />
<h3>
  <a name="Comments_about_this_recipe"> Comments about this recipe </a>
</h3>
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/WillFarr">WillFarr</a> - 24 Aug 2007
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/MacrosChapterRecipes">MacrosChapterRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 999 </td>
</tr>
</table>
<p />
 </div>
</div>
