<div id="contentbox">
 <div class="widget">
  <p />
<h2>
  <a name="Sending_Email"> Sending Email </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You want to send an email from a Scheme program
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
<p />
Use the <code>smtp.ss</code> or <code>sendmail.ss</code> modules, and the <code>head.ss</code> module, all in the <code>net</code> collection.  Since SMTP is more universal the sendmail, the examples will use SMTP.
<p />
The function <code>send-email</code> below uses the libraries to send an email to a single recipient.  It requires you specify the name of your SMTP server, and you should replace "your-email-address" with your actual email address.
<p />
<div class="scheme">
  <pre>(<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"smtp.ss"</span> <span class="selfeval">"net"</span>)
         (<span class="variable">lib</span> <span class="selfeval">"head.ss"</span> <span class="selfeval">"net"</span>))
<span class="comment">;; send-email : string string string string
</span>(<span class="keyword">define</span> (<span class="variable">send-email</span> <span class="variable">server</span> <span class="variable">recipient</span> <span class="variable">subject</span> <span class="variable">body</span>)
  (<span class="keyword">let</span> ((<span class="variable">header</span>
         (<span class="variable">insert-field</span>
          <span class="selfeval">"Subject"</span>
          <span class="variable">subject</span>
          (<span class="variable">insert-field</span>
           <span class="selfeval">"From"</span>
           <span class="selfeval">"your-email-address"</span>
           (<span class="variable">insert-field</span>
            <span class="selfeval">"To"</span>
            <span class="variable">recipient</span>
            <span class="variable">empty-header</span>)))))
    (<span class="variable">smtp-send-message</span> <span class="variable">server</span>
                       <span class="selfeval">"your-email-address"</span>
                       (<span class="builtin">list</span> <span class="variable">recipient</span>)
                       <span class="variable">header</span>
                       (<span class="builtin">list</span> <span class="variable">body</span>))))
</pre>
</div>
<p />
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
<p />
<a href="http://en.wikipedia.org/wiki/SMTP" target="_top">SMTP</a> stands for Simple Mail Transport Protocol, and is the Internet standard for email.
<p />
To send encrypted mail;
<p />
<div class="scheme">
  <pre>
(<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"smtp.ss"</span> <span class="selfeval">"net"</span>)
         (<span class="variable">lib</span> <span class="selfeval">"dns.ss"</span> <span class="selfeval">"net"</span>)
         (<span class="variable">lib</span> <span class="selfeval">"mzssl.ss"</span> <span class="selfeval">"openssl"</span>)
         (<span class="variable">lib</span> <span class="selfeval">"head.ss"</span> <span class="selfeval">"net"</span>)
         )
(<span class="variable">printf</span> <span class="selfeval">"ssl-available? ~s~n"</span> <span class="variable">ssl-available?</span>) <span class="comment">; just checking
</span>(<span class="variable">smtp-send-message</span>
 (<span class="variable">dns-get-address</span> (<span class="variable">dns-find-nameserver</span>) <span class="selfeval">"smtp.gmail.com"</span>) <span class="comment">; server-string
</span> <span class="selfeval">"username@gmail.com"</span> <span class="comment">; from-string
</span> <span class="keyword">'</span>(<span class="selfeval">"someone@else.com"</span>) <span class="comment">; to-list-of-strings
</span> (<span class="variable">insert-field</span> <span class="selfeval">"From"</span> <span class="selfeval">"spdegabrielle@gmail.com"</span>
   (<span class="variable">insert-field</span> <span class="selfeval">"To"</span> <span class="selfeval">"someone@else.com"</span> <span class="variable">empty-header</span>)) <span class="comment">;; header
</span> <span class="keyword">'</span>(<span class="selfeval">"This works!"</span> <span class="selfeval">"#:tcp-connect ssl-connect"</span>) <span class="comment">;; message-list-of-strings/bytes
</span> <span class="variable">#:port-no</span> <span class="selfeval">465</span>
 <span class="variable">#:auth-user</span> <span class="selfeval">"username"</span>  <span class="comment">; for gmail don't include the @gmail.com
</span> <span class="variable">#:auth-passwd</span> <span class="selfeval">"yourpass"</span>
 <span class="variable">#:tcp-connect</span> <span class="variable">ssl-connect</span>
 <span class="comment">;#:tls-encode ports-&gt;ssl-ports ; the other option
</span> )
</pre>
</div>
<p />
an example.
<p />
-- <a href="/Main/StephenDeGabrielle">StephenDeGabrielle</a> - 14 Nov 2007
<p />
How about a retrieval example?
<p />
-- <a href="/Main/StephenDeGabrielle">StephenDeGabrielle</a> - 21 Nov 2007
<p />
To do SSL retrieval, the pop-3 libraries could be modified to make a SSL connection. looks simple enough, but I haven't tried yet :)
<p />
<p />
-- <a href="/Main/StephenDeGabrielle">StephenDeGabrielle</a> - 27 Nov 2007
<p />
<p />
<hr>
<p />
<h3>
  <a name="Comments_about_this_recipe"> Comments about this recipe </a>
</h3>
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/NoelWelsh">NoelWelsh</a> - 12 Jan 2006
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/NetRecipes">NetRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 999 </td>
</tr>
</table>
<p />
 </div>
</div>
