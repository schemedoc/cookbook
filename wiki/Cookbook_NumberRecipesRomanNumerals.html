<div id="contentbox">
 <div class="widget">
 <h2>
  <a name="Working_with_Roman_Numerals"> Working with Roman Numerals </a>
</h2>
<p />
<h3>
  <a name="Problem"> Problem </a>
</h3>
<p />
You want to convert decimal numbers to Roman numerals and Roman numerals to decimal numbers.
<p />
<h3>
  <a name="Solution"> Solution </a>
</h3>
Here is some example code illustrating the conversion between decimals numbers and Roman numerals.
<div class="scheme">
  <pre><span class="comment">; decimal-&gt;roman : integer -&gt; string
</span><span class="comment">;   format the integer num using roman numerals
</span>(<span class="keyword">define</span> (<span class="variable">decimal-&gt;roman</span> <span class="variable">num</span>)
  (<span class="keyword">let</span> ((<span class="variable">decimal-numbers</span> (<span class="builtin">list</span> <span class="selfeval">1000</span> <span class="selfeval">900</span> <span class="selfeval">500</span> <span class="selfeval">400</span> <span class="selfeval">100</span> <span class="selfeval">90</span> <span class="selfeval">50</span> <span class="selfeval">40</span> <span class="selfeval">10</span> <span class="selfeval">9</span> <span class="selfeval">5</span> <span class="selfeval">4</span> <span class="selfeval">1</span>))
        (<span class="variable">roman-numbers</span>   (<span class="builtin">list</span> <span class="selfeval">"M"</span> <span class="selfeval">"CM"</span> <span class="selfeval">"D"</span> <span class="selfeval">"CD"</span> <span class="selfeval">"C"</span> <span class="selfeval">"XC"</span> <span class="selfeval">"L"</span>
                               <span class="selfeval">"XL"</span> <span class="selfeval">"X"</span> <span class="selfeval">"IX"</span> <span class="selfeval">"V"</span> <span class="selfeval">"IV"</span> <span class="selfeval">"I"</span>)))
    (<span class="variable">decimal-&gt;roman-aux</span> <span class="variable">num</span> <span class="selfeval">""</span> <span class="variable">decimal-numbers</span> <span class="variable">roman-numbers</span>)))
<span class="comment">; decimal-&gt;roman-aux : integer string (list number) (list string) -&gt; string
</span><span class="comment">;   append the numbers num formatted as roman numerals to the string s,
</span><span class="comment">;   using the roman numerals in roman-numbers with corresponding
</span><span class="comment">;   decimal values in decimal-values
</span>(<span class="keyword">define</span> (<span class="variable">decimal-&gt;roman-aux</span> <span class="variable">num</span> <span class="variable">s</span> <span class="variable">decimal-numbers</span> <span class="variable">roman-numbers</span>)
  (<span class="keyword">if</span> (<span class="builtin">null?</span> <span class="variable">decimal-numbers</span>)
      <span class="variable">s</span>
      (<span class="keyword">if</span> (<span class="builtin">&gt;=</span> <span class="variable">num</span> (<span class="builtin">car</span> <span class="variable">decimal-numbers</span>))
          (<span class="variable">decimal-&gt;roman-aux</span> (<span class="builtin">-</span> <span class="variable">num</span> (<span class="builtin">car</span> <span class="variable">decimal-numbers</span>))
                              (<span class="builtin">string-append</span> <span class="variable">s</span> (<span class="builtin">car</span> <span class="variable">roman-numbers</span>))
                              <span class="variable">decimal-numbers</span> <span class="variable">roman-numbers</span>)
          (<span class="variable">decimal-&gt;roman-aux</span> <span class="variable">num</span> <span class="variable">s</span>
                              (<span class="builtin">cdr</span> <span class="variable">decimal-numbers</span>) (<span class="builtin">cdr</span> <span class="variable">roman-numbers</span>)))))
</pre>
</div>
And here is the reverse transformation (converting between Roman numerals and decimal numbers):
<div class="scheme">
  <pre>(<span class="keyword">require</span> (<span class="variable">lib</span> <span class="selfeval">"13.ss"</span> <span class="selfeval">"srfi"</span>))
(<span class="variable">read-case-sensitive</span> <span class="selfeval">#t</span>) <span class="comment">; due to the case expression
</span>
<span class="comment">; roman-&gt;decimal : string -&gt; integer
</span><span class="comment">;  convert a string with (uppercase) roman numerals to an integer
</span>(<span class="keyword">define</span> (<span class="variable">roman-&gt;decimal</span> <span class="variable">s</span>)
  (<span class="keyword">cond</span>
    [(<span class="variable">string=</span> <span class="variable">s</span> <span class="selfeval">""</span>)              <span class="selfeval">0</span>]
    [(<span class="builtin">=</span> (<span class="builtin">string-length</span> <span class="variable">s</span>) <span class="selfeval">1</span>)    (<span class="keyword">case</span> (<span class="builtin">string-&gt;symbol</span> <span class="variable">s</span>)
                                  [(<span class="variable">I</span>)     <span class="selfeval">1</span>]
                                  [(<span class="variable">V</span>)     <span class="selfeval">5</span>]
                                  [(<span class="variable">X</span>)    <span class="selfeval">10</span>]
                                  [(<span class="variable">L</span>)    <span class="selfeval">50</span>]
                                  [(<span class="variable">C</span>)   <span class="selfeval">100</span>]
                                  [(<span class="variable">D</span>)   <span class="selfeval">500</span>]
                                  [(<span class="variable">M</span>)  <span class="selfeval">1000</span>]
                                  [<span class="keyword">else</span>    <span class="selfeval">0</span>])]
    [<span class="keyword">else</span>                       (<span class="builtin">+</span> (<span class="variable">roman-&gt;dec</span> (<span class="variable">string-drop</span> <span class="variable">s</span> <span class="selfeval">2</span>))
                                   (<span class="keyword">case</span> (<span class="builtin">string-&gt;symbol</span> (<span class="variable">substring/shared</span> <span class="variable">s</span> <span class="selfeval">0</span> <span class="selfeval">2</span>))
                                     [(<span class="variable">IV</span>)    <span class="selfeval">4</span>]
                                     [(<span class="variable">IX</span>)    <span class="selfeval">9</span>]
                                     [(<span class="variable">XL</span>)   <span class="selfeval">40</span>]
                                     [(<span class="variable">XC</span>)   <span class="selfeval">90</span>]
                                     [(<span class="variable">CD</span>)  <span class="selfeval">400</span>]
                                     [(<span class="variable">CM</span>)  <span class="selfeval">900</span>]
                                     [<span class="keyword">else</span>    (<span class="builtin">+</span> (<span class="variable">roman-&gt;dec</span> (<span class="variable">substring/shared</span> <span class="variable">s</span> <span class="selfeval">0</span> <span class="selfeval">1</span>))
                                                 (<span class="variable">roman-&gt;dec</span> (<span class="variable">string-drop</span> <span class="variable">s</span> <span class="selfeval">1</span>)))]))]))
</pre>
</div>
<p />
<h3>
  <a name="Discussion"> Discussion </a>
</h3>
In the first code sample we show a very simple solution; the main procedure takes the number to be converted.  It then calls an auxilliary procedure that performs the actual conversion.  The auxilliary procedure takes four arguments:  (1) the number we want to convert, (2) an accumulator string that will (eventually) contain the result, (3) a list containing the decimal integers that we can represent as roman numerals, and (4) a list of corresponding roman numeral representations of the decimal values.
<p />
We have three cases to consider:
<p />
<ul>
<li> If the list <code>decimal-numbers</code> is empty we just return the accumulator string, which is the value we are seeking.
</li>
<li> Otherwise, we need to make a recursive call.  There are two possibilities:
<ol>
<li> If the number is greater than or equal to the first element of the decimals list:
<ul>
<li> Use the difference of the first argument (the number to be converted) and the "value" of the roman numeral we are currently considering for the first argument.
</li>
<li> Append the roman numeral character currently being considered to the accumulator and pass this as the second argument.
</li>
<li> The other two arguments are the decimal and roman lists without changes.
</li>
</ul>
</li>
<li> Otherwise, the number must be less than the first element of the decimal list:
<ul>
<li> Use the input number without changes for the first argument.
</li>
<li> Use the existing accumulator string for the second argument.
</li>
<li> The final two arguments are the decimal and roman numeral lists (without their first element).
</li>
</ul>
</li>
</ol>
</li>
</ul>
<p />
In the second code example we use <a href="/Cookbook/SRFI">SRFI</a> 13 that defines many procedures for manipulating strings.  This problem would be difficult to solve without those helpful implementations.
<p />
The main idea of this algorithm is two handle two cases:  (1) The first character of the string is a simple symbol (an atom) (I,V,X,L,C,D,M); and (2) the first two characters of the string form a double symbol (IV, IX, XL, XC, CD, CM).
<p />
Once we determine which condition we are dealing with, we just sum the decimal values of the symbol that we have recognized.
<p />
<h3>
  <a name="Contributors"> Contributors </a>
</h3>
<p />
-- <a href="/Main/EmiliaBarajas">EmiliaBarajas</a> - 18 May 2004
<p />
Substantially revised the text of the recipe, but the coding is unchanges.
-- <a href="/Main/BrentAFulgham">BrentAFulgham</a> - 24 Aug 2004
  <p />
<table border="1" cellspacing="0" cellpadding="0">
   <tr>
  <th colspan="2" align="center" bgcolor="#99CCCC"> <a href="/Cookbook/CookbookForm">CookbookForm</a> </th>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicType">TopicType</a>:</th>
  <td align="left"> Recipe </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/ParentTopic">ParentTopic</a>:</th>
  <td align="left"> <a href="/Cookbook/NumberRecipes">NumberRecipes</a> </td>
</tr>
<tr>
  <th bgcolor="#99CCCC" align="right"> <a href="/Cookbook/TopicOrder">TopicOrder</a>:</th>
  <td align="left"> 060 </td>
</tr>
</table>
<p />
 </div>
</div>
